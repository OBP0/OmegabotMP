# Пример 4.4 - Тотальная слежка

В данном примере показано как можно подключить сразу 4 инфракрасных датчика расстоянии и считывать с них значения параллельно фильтруя их при помощи фильтра скользящего среденго, как было показано в примерах 4.1 и 4.2. Получаемые с датчиков значения выводятся в Serial порт каждую секунду, но вы можете найти им другое применение.

## Описание работы программы:

1. Инициализация массивов:
   - Массив IR_pin содержит адреса четырех аналоговых портов, к которым подключены ИК-датчики.
   - Массив sensor хранит отфильтрованные значения показаний АЦП для каждого датчика.

2. Обработчик прерывания WDT:
   - В функции ISR(WDT_vect) реализуется прерывание на Watchdog Timer (WDT).
   - Внутри функции происходит циклическое чтение показаний с каждого ИК-датчика и применение фильтра для сглаживания этих показаний.

3. Функция преобразования показаний в расстояние:
   - Функция Read_IR принимает отфильтрованное показание и конвертирует его в расстояние в сантиметрах.

4. Настройка программы в `setup()`:
   - В функции setup() настраиваются параметры работы программы:
     - Устанавливается связь с компьютером через последовательный порт (Serial.begin(9600)).
     - Выполняется настройка Watchdog Таймера (WDT):
       - Прерывания временно отключаются командой cli().
       - Команда asm("wdr") сбрасывает WDT.
       - Команды WDTCSR = (1 << WDCE) | (1 << WDE) разрешают изменение параметров WDT.
       - Устанавливается частота срабатывания WDT. В данном случае выбрана частота 16 Гц (период ≈64 мс), что соответствует настройкам WDTCSR = 0 | (1 << WDP1) | (1 << WDIE ).
       - После завершения настройки прерывания снова включаются командой sei().

5. Основной цикл программы в `loop()`:
   - В основном цикле программы выполняются следующие действия:
     - Программа ожидает одну секунду (delay(1000)).
     - Для каждого датчика последовательно вызывается функция Read_IR, которая рассчитывает расстояние на основе отфильтрованных показаний.
     - Рассчитанные расстояния отправляются в последовательный порт для отображения на компьютере.

Таким образом, программа непрерывно измеряет расстояния с использованием четырех ИК-датчиков, применяя фильтр для сглаживания показаний в обработчике прерывания WDT, а затем выводит результаты измерений в последовательный порт.